#!/usr/bin/env python
# Given a list of lcsh subjects, retrieve the id.loc.gov URIs and write the
# mapping to a csv file.

from requests import get
from urllib import quote
import csv

OUTPUT_FILE_NAME='/tmp/subjects_to_lcsh.csv'

TERMS = ['AIDS (Disease)', 'Abandoned children', 'Abortion', 'Adult education', 'Advertising--Tourism', 'Affirmative action', 'Afro-Brazilian cults', 'Afro-Caribbean cults', 'Agricultural development projects', 'Agricultural industries', 'Agricultural laws and legislation', 'Agricultural technology', 'Agricultural workers', 'Agriculture and politics', 'Agriculture and state', 'Agriculture--Economic aspects', 'Agriculture--Handbooks, manuals, etc.', 'Alcoholism', 'Alternative medicine', 'Anglicans', 'Arabs', 'Archaeological sites', 'Architecture', 'Archives', 'Armed Forces', 'Art', 'Arts--Political aspects', 'Arts-political aspects', 'Asians', 'Atheism', 'Bible', 'Birth control', 'Bisexuals', 'Blacks', 'Business', 'Catholic Church', 'Catholics', 'Celebrities', 'Child abuse', 'Child care', 'Child labor', 'Child sexual abuse', 'Children and politics', "Children's rights", 'Children--Crimes against', 'Children--Government policy', 'Children--Legal status, laws, etc.', 'Christians', 'Church and state', 'City planning', 'Collective memory', 'College students', 'Commerce', 'Communication', 'Community development', 'Community development--Environmental aspects. ', 'Constitutions', 'Consumer protection', 'Consumer protection--Political aspects.', 'Contraception', 'Cooperative societies', 'Crime', 'Crime prevention', 'Cults', 'Debts, External', 'Decentralization in government', 'Democracy', 'Demography', 'Disappeared persons', 'Discrimination', 'Documentation', 'Dropouts', 'Drug abuse', 'Drug traffic', 'Drugs--Therapeutic use', 'Economic assistance', 'Economic conditions', 'Economic development', 'Economic development projects', 'Economic policy', 'Economic policy--Social aspects', 'Economic policy--citizen participation', 'Economics--Political aspects', 'Economics--Research', 'Economy', 'Ecotourism', 'Ecumenical movement', 'Education', 'Education and state', 'Education, Bilingual', 'Education, Higher', 'Education, Primary', 'Education, Rural', 'Education, Secondary', 'Education--Parent participation', 'Education--Political aspects', 'Education--Study and teaching', 'Educational change', 'Educational law and legislation', 'Educational system', 'Elections', 'Employment', 'Energy conservation', 'Environmental education', 'Environmental health', 'Environmental law', 'Environmental policy', 'Environmental protection', 'Environmentalism', 'Episcopal Church', 'Episcopalians', 'Ethnic art', 'Europeans', 'Evangelicalism', 'Fairs', 'Family', 'Family planning', 'Feminism', 'Festivals', 'Finance', 'Fiscal policy', 'Fisheries', 'Fishing', 'Folk art', 'Folklore', 'Forced migration', 'Foreign relations', 'Forests and forestry', 'Freedom of expression', 'Freedom of the press', 'Gangs', 'Gastronomy', 'Gay culture', 'Gay rights', 'Gays--Legal status, laws, etc.', 'Genetically modified foods', 'Global warming', 'Globalization', 'Government policy', 'Guerrillas', 'Guidebooks', 'HIV infections', 'HIV-positive women', 'Health', 'Health care', 'Health education', 'Health facilities', 'Health policy', 'Health--Environmental aspects', 'Homophobia', 'Homosexuality--Government policy ', 'Housing', 'Housing policy', 'Human rights advocacy', 'Human rights--Government policy', 'Human rights--Law and legislation', 'Hydrocarbons', 'Immigrants', 'Immunization', 'Independent churches', 'Indians--Religion', 'Indigenous art', 'Indigenous peoples ', 'Indigenous peoples--Civil rights', 'Indigenous peoples--Legal status, laws, etc.', 'Indigenous women', 'Industries', 'Infants', 'Inflation', 'Informal sector (Economics)', 'Infrastructure (Economics)', 'Intellectuals', 'International agencies', 'International business enterprises', 'International organizations', 'Investments, Foreign', 'Islam', "Jehova's Witnesses", 'Jews', 'Judaism', 'Juvenile delinquency', 'Labor laws and legislation', 'Labor market ', 'Labor unions', 'Labor unions--Political activity', 'Land reform', 'Land tenure--Social aspects', 'Land use, urban', 'Language and languages', 'Laws', 'Leisure', 'Lesbian culture', 'Liberation theology', 'Literacy', 'Literature', 'Local elections', 'Local government', 'Local government --Economic aspects', 'Marine resources', 'Mass media', 'Massacres', 'Mental health', 'Microfinance', 'Migrant Labor', 'Mineral industries--environmental aspects', 'Mines and mineral resources', 'Minorities--Civil rights', 'Minorities--Education', 'Minorities--Legal status, laws, etc.', 'Minorities--Politics and government', 'Missing children', 'Missionaries', 'Monuments', 'Motion pictures', 'Multicultural education', 'Municipal government', 'Museums', 'Music', 'Muslims', 'Natural disasters', 'Natural gas', 'Natural resources', 'Nature conservation', 'Non-governmental organizations', 'Nutrition', 'Oil industries', 'Older people', 'Organic farming', 'Paramilitaries', 'Paramilitary forces', 'Parks', 'Peace agreements', 'Peace negotiations', 'Pensions', 'People with disabilities', 'Performing arts', 'Pests', 'Petroleum industry and trade', 'Police', 'Police brutality', 'Policy analysis', 'Political activists', 'Political activity', 'Political campaigns', 'Political corruption', 'Political participation', 'Political parties', 'Political prisoners', 'Political violence', 'Politics and culture', 'Politics and government--Citizen participation', 'Pollution', 'Poor children', 'Poor-Education', 'Popular culture', 'Popular education', 'Population', 'Poverty', 'Power resources', 'Power resources--Environmental aspects', 'Presidents--Election', 'Prisons', 'Privatization ', 'Prostitution', 'Protest movements', 'Protestant churches', 'Protestants', 'Public health--Citizenship participation', 'Public investments', 'Public works', 'Racism', 'Radio programs', 'Rain forests', 'Real estate business', 'Recreation', 'Recycling (Waste, etc.)', 'Refugees', 'Regulations', 'Religion and politics', 'Religious architecture', 'Religious art', 'Religious education', 'Reproductive health', 'Reproductive rights', 'Revolutionaries', 'Rites and ceremonies', 'Rural development projects', 'Rural women', 'Sanitation', 'Schools', 'Science', 'Self-determination, National', 'Sex', 'Sex discrimination', 'Sex discrimination against women', 'Sex instruction', 'Sexual health', 'Sexual minorities', 'Small business', 'Social movements', 'Social policy', 'Social policy--citizen participation', 'Social rights--Government policy', 'Spiritualism', 'Squatter settlements', 'State-sponsored terrorism', 'Street children', 'Strikes and lockouts', 'Student movements', 'Student unions', 'Students--Political activity', 'Substance abuse', 'Sustainable agriculture', 'Sustainable development', 'Taxation', 'Teachers', "Teachers' unions", 'Teaching--Aids and devices', 'Technical assistance', 'Technology', 'Teenagers', 'Television programs', 'Terrorism', 'Torture', 'Tourism', 'Tourism and art', 'Tourism and gastronomy', 'Tourism--Economic aspects', 'Tourism--Social aspects', 'Tourist camps, hostels, etc.', 'Tourist maps', 'Trade associations', 'Traditional farming', 'Traditional medicine', 'Transgender people', 'Transgenic plants', 'Transportation', 'Transvestites', 'Truth commissions', 'Unemployed', 'Unemployment', 'United States--Relations--Latin America', 'Universities and colleges', 'Urban policy--Environmental aspects', 'Urban population', 'Urban renewal', 'Urban transportation', 'Urban-rural migration', 'Violence', 'Vocational education', 'Voting', 'War', 'Waste disposal', 'Water conservation', 'Water resources development', 'Water use', 'Wildlife conservation', 'Wildlife management', 'Women household employees', 'Women in art', "Women's rights", 'Women--Crimes against', 'Women--Education', 'Women--Employment', 'Women--Government policy', 'Women--Health and hygiene', 'Women--Legal status, laws, etc.', 'Women--Political activity', 'Women--Sexual behavior', 'Women--identity', 'Youth', 'Youth employment', 'Youth--Attitudes', 'Youth--Conduct of life']
LOC_LABEL = "http://id.loc.gov/authorities/subjects/label/"
URI_HEADER = "X-URI"

def uri_for_term(term):
    label_uri = "%s%s" % (LOC_LABEL,quote(term))
    r = get(label_uri, allow_redirects=False)
    return r.headers[URI_HEADER] if r.status_code == 302 else None

with open(OUTPUT_FILE_NAME, 'wb') as csvfile:
    f = csv.writer(csvfile, quoting=csv.QUOTE_ALL)
    [f.writerow((t,uri_for_term(t))) for t in TERMS]
